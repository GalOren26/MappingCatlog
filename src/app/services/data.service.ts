import { Injectable } from '@angular/core';
import { Model } from '@models/model.dt';
import { Observable, of, scheduled, BehaviorSubject } from 'rxjs';
import { HttpClient } from '@angular/common/http';

@Injectable({
  providedIn: 'root',
})
export class DataService {
  models: BehaviorSubject<Model[]> = new BehaviorSubject<Model[]>([
    {
      name: 'שועפט',
      engName: 'Shoufat',
      url: '../../../assets/models/Shoufat.glb',
      coordinates: [
        [31.807729, 35.239312],
        [31.807729, 35.241681],
        [31.806603, 35.241681],
        [31.806603, 35.248921],
        [31.805838, 35.248921],
        [31.805838, 35.251116],
        [31.804685, 35.251116],
        [31.804685, 35.253289],
        [31.807422, 35.253289],
        [31.807422, 35.254311],
        [31.812008, 35.254311],
        [31.812008, 35.251256],
        [31.813805, 35.251256],
        [31.813805, 35.248159],
        [31.815605, 35.248159],
        [31.815605, 35.247136],
        [31.816595, 35.247136],
        [31.816595, 35.242891],
        [31.815811, 35.242891],
        [31.815811, 35.241759],
        [31.814864, 35.241759],
        [31.814864, 35.240709],
        [31.813046, 35.240709],
        [31.813046, 35.239312],
      ],
    },
    {
      name: 'חברון',
      engName: 'Hebron',
      url: '../../../assets/models/Hebron.glb',
      coordinates: [
        [31.532036593126875, 35.11181788968027],
        [31.53202788251528, 35.112345171176365],
        [31.532019201045753, 35.11287055764238],
        [31.532010399095174, 35.113403102017344],
        [31.53199813690186, 35.11340282572462],
        [31.53198953812068, 35.113922948332686],
        [31.532001800309885, 35.11392322469328],
        [31.53199308102798, 35.11445050527641],
        [31.531984272505827, 35.11498304895914],
        [31.531528137394464, 35.114972763720345],
        [31.531076510402933, 35.11496258036443],
        [31.530626506312593, 35.11495243383033],
        [31.530181010343732, 35.11494238916834],
        [31.530172405744498, 35.11546250118704],
        [31.53016359346286, 35.11599503418895],
        [31.529707458520242, 35.115984744763615],
        [31.5292558316958, 35.115974557262625],
        [31.52880582777193, 35.11596440659846],
        [31.52835420087784, 35.11595421955452],
        [31.52790419688459, 35.11594406934575],
        [31.527458701011838, 35.11593402104597],
        [31.52745009304353, 35.116454117644125],
        [31.52744137142381, 35.11698095074499],
        [31.526989744730518, 35.11697075935303],
        [31.52698965062096, 35.11697644343784],
        [31.52653351574165, 35.11696615051996],
        [31.526083511915008, 35.11695599618215],
        [31.525638016207207, 35.11694594379479],
        [31.52562940456826, 35.11746602996329],
        [31.525620585079185, 35.11799853649746],
        [31.525164450404134, 35.11798823916364],
        [31.524712823844613, 35.1179780438325],
        [31.524721555869444, 35.117450805353904],
        [31.524730254356324, 35.11692546129564],
        [31.5242802503909, 35.11691530786894],
        [31.523828623455103, 35.11690511805259],
        [31.52383735083955, 35.11637788417419],
        [31.52384604470277, 35.11585254469971],
        [31.52385476775348, 35.11532531036431],
        [31.523853685795206, 35.11532528597115],
        [31.523844962744878, 35.115852520300486],
        [31.523396040362613, 35.115842396767654],
        [31.52294441305071, 35.11583221246564],
        [31.522953135795074, 35.11530498318748],
        [31.52296182503495, 35.11477964829681],
        [31.522511820320194, 35.114769505858945],
        [31.522060192632377, 35.11475932707081],
        [31.52206891073693, 35.114232102392904],
        [31.522077595353757, 35.113706772086104],
        [31.521627590264583, 35.11369663514197],
        [31.521175962200996, 35.11368646186725],
        [31.520725957042455, 35.113676325377924],
        [31.520274328909252, 35.11366615255964],
        [31.52028304206828, 35.11313893753863],
        [31.520291721757502, 35.112613616854155],
        [31.520291833043878, 35.11260688062271],
        [31.519846335679354, 35.11259685114985],
        [31.519846224394914, 35.11260358734938],
        [31.519390087715916, 35.11259331855231],
        [31.519398796235908, 35.11206610813144],
        [31.519407589481595, 35.11153363484721],
        [31.51986282483694, 35.11154387821462],
        [31.520309224137893, 35.11155392298582],
        [31.52031781044764, 35.111033864304645],
        [31.52032648150162, 35.11050854271139],
        [31.520326738594747, 35.11049296514918],
        [31.520328074406226, 35.11041202497467],
        [31.52033055655207, 35.110261617275896],
        [31.52033462244281, 35.11001521805953],
        [31.52034136893419, 35.109606306819416],
        [31.520343966462715, 35.10944884701055],
        [31.52080010399973, 35.109459100912495],
        [31.521245602200292, 35.109469115869224],
        [31.52125418026255, 35.108949051301046],
        [31.52126296099608, 35.10841656642212],
        [31.521719008607626, 35.10842681365086],
        [31.522164597204412, 35.108436826094604],
        [31.52217317129324, 35.10791675608899],
        [31.522181947958384, 35.107384265642885],
        [31.522197906928803, 35.10738462406858],
        [31.52220656345895, 35.10685929071801],
        [31.52222279292583, 35.10685965512831],
        [31.5222314785144, 35.10633242684887],
        [31.522655428382112, 35.10634194378203],
        [31.523100927348683, 35.10635194467186],
        [31.523109493188898, 35.105831868779994],
        [31.523118143565963, 35.10530652980244],
        [31.523126822973683, 35.1047792959669],
        [31.523135586816146, 35.10424679903505],
        [31.52359172568297, 35.10425702877822],
        [31.524037225182358, 35.10426702013915],
        [31.524045782773328, 35.10374693836165],
        [31.52405442481757, 35.103221593439116],
        [31.523604416824877, 35.103211505977704],
        [31.523152785847316, 35.10320138236307],
        [31.523161456587548, 35.102674147618764],
        [31.523170211676003, 35.10214164976933],
        [31.523618687221564, 35.102151697588994],
        [31.523610018522366, 35.10267893507857],
        [31.523613174259832, 35.10267900579946],
        [31.523621842960107, 35.10215176829219],
        [31.524071851258267, 35.102161850679984],
        [31.524080400299084, 35.10164176800648],
        [31.524089033706655, 35.101116422179096],
        [31.52409769608357, 35.100589181469466],
        [31.524106325172788, 35.10006383518999],
        [31.524107296696382, 35.10000467977433],
        [31.524118719556203, 35.09930902450262],
        [31.524123563062506, 35.09901398402513],
        [31.5241236079866, 35.09901124729543],
        [31.524132261695613, 35.09848400567881],
        [31.52414088214808, 35.09795865849585],
        [31.52414953152314, 35.09743141642609],
        [31.52415826503304, 35.096898911178634],
        [31.524614405980145, 35.09690910562376],
        [31.52506603867969, 35.09691919954131],
        [31.52532661332977, 35.09692502344601],
        [31.525366015101124, 35.09692590409147],
        [31.525967681018212, 35.09693935178213],
        [31.526417690657446, 35.096949410103775],
        [31.526869323217927, 35.09695950492712],
        [31.526860675122265, 35.09748676243445],
        [31.526852055944385, 35.09801212499954],
        [31.52693527745645, 35.0980139861125],
        [31.52730206521168, 35.09802218881269],
        [31.527753697398882, 35.098032289147476],
        [31.528203706596898, 35.09804235341215],
        [31.528655338714554, 35.098052454200094],
        [31.52864668567674, 35.09857972137144],
        [31.528638061574313, 35.0991050935657],
        [31.52862940420178, 35.099632360283685],
        [31.528620775780222, 35.1001577320261],
        [31.528612114072978, 35.10068499829051],
        [31.528603481332297, 35.10121036958087],
        [31.528594815290365, 35.10173763539148],
        [31.528586178230565, 35.10226300622954],
        [31.52857750785395, 35.10279027158613],
        [31.528568866475055, 35.103315641971676],
        [31.52856019176377, 35.103842906874],
        [31.52855154606579, 35.10436827680682],
        [31.528542790771855, 35.10490017284392],
        [31.528532331779232, 35.10489993816202],
        [31.52852375801368, 35.10542067599465],
        [31.528534217002786, 35.1054209107345],
        [31.528525446933475, 35.105953437892715],
        [31.52852202071408, 35.105953360975754],
        [31.52851333514176, 35.10648062471953],
        [31.528060623497662, 35.10647045913457],
        [31.527615124910714, 35.10646045574225],
        [31.52760655542254, 35.106980556389175],
        [31.52759789707144, 35.107505919922076],
        [31.52758920532684, 35.1080331779466],
        [31.527580471485958, 35.10856285677053],
        [31.527571846577818, 35.10908579859503],
        [31.527563179588977, 35.109611161220464],
        [31.52755447917549, 35.11013841833402],
        [31.52754580786779, 35.11066378050538],
        [31.527995813422073, 35.11067390525399],
        [31.528447441882822, 35.11068406674538],
        [31.528438686424302, 35.11121438108412],
        [31.52843006089801, 35.11173669521887],
        [31.52888006607829, 35.111746825462184],
        [31.529331694163705, 35.1117569924682],
        [31.52978169927462, 35.11176712316602],
        [31.529781323730095, 35.11178986025803],
        [31.53022682063459, 35.111799889797425],
        [31.530227196185624, 35.111777152597625],
        [31.53054430052358, 35.11178429167479],
        [31.530795495474575, 35.11178994699187],
        [31.53113496027814, 35.11179758969887],
        [31.53158496525032, 35.111807721305745],
        [31.532036593126875, 35.11181788968027],
      ],
    },
    {
      name: 'קסבה',
      engName: 'Kasba',
      url: '../../../assets/models/Kasba.glb',
      coordinates: [
        [31.52787811970195, 35.106921490914964],
        [31.527868597638154, 35.107499268273166],
        [31.527745028439558, 35.10749649224627],
        [31.527735660858017, 35.108064743388],
        [31.52735793865671, 35.108056255540895],
        [31.527350825709384, 35.10848763957559],
        [31.526902730942094, 35.108477568525004],
        [31.526909773498065, 35.108050448579014],
        [31.526902244840016, 35.10805027940658],
        [31.52689363651359, 35.10857234921933],
        [31.526807016400735, 35.10857040234805],
        [31.526798374721817, 35.10909436615671],
        [31.52647763605782, 35.1090871555261],
        [31.526469023689998, 35.109609217364834],
        [31.526457825385155, 35.109608965551885],
        [31.526449179450843, 35.11013293232313],
        [31.52629634337659, 35.11012949470468],
        [31.526287813501842, 35.11064630268626],
        [31.526327665736527, 35.11064719926732],
        [31.526318928857037, 35.11117641745839],
        [31.526142064336945, 35.11117243744123],
        [31.526134466390552, 35.111632561590476],
        [31.52589805802448, 35.11162724054238],
        [31.525891066684817, 35.11205054343631],
        [31.52542446952127, 35.112040039409386],
        [31.525422935491772, 35.11213290978362],
        [31.524683507591565, 35.11211626356567],
        [31.524688323867085, 35.1118246657024],
        [31.524067999771784, 35.111810703185384],
        [31.52407192950068, 35.11157274661665],
        [31.523575670101117, 35.11156157816965],
        [31.523578640470184, 35.111381693311536],
        [31.52284664867797, 35.11136522155354],
        [31.52285491217757, 35.11086469490426],
        [31.52286345756634, 35.1103469691121],
        [31.52285005927128, 35.11034666776585],
        [31.522838747615953, 35.11103196197012],
        [31.522121587463648, 35.11101582710173],
        [31.52213298565611, 35.11032527533397],
        [31.522390258194143, 35.11033106156402],
        [31.522390404803186, 35.11032217794712],
        [31.521994316529725, 35.110313269727435],
        [31.522002712907994, 35.10980443208061],
        [31.522105174750113, 35.10980673592545],
        [31.522113731475628, 35.10928805608622],
        [31.522150671488134, 35.1092888864777],
        [31.522161804933003, 35.10861382424988],
        [31.522320042055238, 35.10861738021413],
        [31.52232090237862, 35.10856520683875],
        [31.521994194549627, 35.108557865149734],
        [31.522004377365302, 35.107940235534336],
        [31.521700002924547, 35.10793339782544],
        [31.5217093813846, 35.10736439059974],
        [31.52219184723052, 35.10737522621905],
        [31.522192062602247, 35.10736215762131],
        [31.52268081282014, 35.107373134578395],
        [31.522680753251926, 35.10737674909178],
        [31.523149054309595, 35.10738726704566],
        [31.523139637504446, 35.10795857970005],
        [31.523151286645167, 35.1079588414116],
        [31.52316083817063, 35.10737935441317],
        [31.52267637978202, 35.10736847360891],
        [31.52224769660315, 35.107358845720256],
        [31.521867602600906, 35.10735030927885],
        [31.521877355631588, 35.10675841084668],
        [31.52213389844564, 35.10676417084581],
        [31.522143823588756, 35.106161660693104],
        [31.522484858933172, 35.10616931567679],
        [31.522492739595435, 35.10569079842515],
        [31.522626172955377, 35.105693792866475],
        [31.5226340672931, 35.10521433796292],
        [31.522775083465973, 35.10521750187518],
        [31.522781710267918, 35.10481494678485],
        [31.52322973425041, 35.10482499711067],
        [31.523231000229746, 35.10474808549757],
        [31.523318017325156, 35.10475003746875],
        [31.523325622996214, 35.10428791466424],
        [31.52370157012514, 35.10429634617286],
        [31.52370045354607, 35.10436419548028],
        [31.524190584098843, 35.10437518841574],
        [31.52419609521015, 35.104040287251124],
        [31.52481642240057, 35.104054198485585],
        [31.52481867951132, 35.103917024596626],
        [31.525270940408454, 35.10392716644749],
        [31.525270786091365, 35.10393654509463],
        [31.525718540562902, 35.10394658616025],
        [31.5257163202567, 35.10408151931779],
        [31.52626732033136, 35.10409387680584],
        [31.526260025886593, 35.10453710930152],
        [31.526812901159357, 35.10454951179797],
        [31.526807047460764, 35.104905127116254],
        [31.52718024424131, 35.10491350054289],
        [31.527169336631026, 35.1055759764253],
        [31.527193013621105, 35.105576507838975],
        [31.52719857895311, 35.105238522573956],
        [31.527596372294276, 35.105247449431985],
        [31.527590806876052, 35.10558543612758],
        [31.527709931159286, 35.10558810985242],
        [31.527698057519114, 35.10630900979114],
        [31.52782200550052, 35.10631179275203],
        [31.527811984685275, 35.10692000557282],
        [31.52787811970195, 35.106921490914964],
      ],
    },
    {
      name: 'רחמא',
      engName: 'Rahma',
      url: '../../../assets/models/Rahma.glb',
      coordinates: [
        [32.175984, 35.229838],
        [32.249805, 35.264656],
        [32.450196, 35.347849],
        [32.275486, 35.319115],
      ],
    },
  ]);

  selectedModel: BehaviorSubject<Model> = new BehaviorSubject<Model>({
    name: 'שועפט',
    engName: 'Shoufat',
    url: '../../../assets/models/Shoufat.glb',
    coordinates: [
      [31.807729, 35.239312],
      [31.807729, 35.241681],
      [31.806603, 35.241681],
      [31.806603, 35.248921],
      [31.805838, 35.248921],
      [31.805838, 35.251116],
      [31.804685, 35.251116],
      [31.804685, 35.253289],
      [31.807422, 35.253289],
      [31.807422, 35.254311],
      [31.812008, 35.254311],
      [31.812008, 35.251256],
      [31.813805, 35.251256],
      [31.813805, 35.248159],
      [31.815605, 35.248159],
      [31.815605, 35.247136],
      [31.816595, 35.247136],
      [31.816595, 35.242891],
      [31.815811, 35.242891],
      [31.815811, 35.241759],
      [31.814864, 35.241759],
      [31.814864, 35.240709],
      [31.813046, 35.240709],
      [31.813046, 35.239312],
    ],
  });

  models$: Observable<Model[]> = this.models.asObservable();

  selectedModel$: Observable<Model> = this.selectedModel.asObservable();
  constructor(private http: HttpClient) {}

  setSelectedModel(model: Model): void {
    this.selectedModel.next(model);
  }

  getAllModels(): Observable<Model[]> {
    return this.models$;
  }

  getSelectedModel(): Observable<Model> {
    return this.selectedModel$;
  }

  downloadCurrentModel(model: Model, quality: string): void {
    switch (quality) {
      case 'איכות נמוכה':
        quality = 'Low';
        break;
      case 'איכות בינונית':
        quality = 'Medium';
        break;
      case 'איכות גבוהה':
        quality = 'High';
        break;
      default:
        break;
    }

    window.open(
      'http://localhost:3000/fbx/' +
        model.engName +
        '/' +
        model.engName +
        '-' +
        quality +
        '.zip'
    );
  }
}
